{"version":3,"sources":["app/AppRoute.tsx","components/DelayedFallback.tsx","features/feed/Feed.tsx","features/feed/FeedHeader.tsx","features/feed/FeedPage.tsx","components/TabBarButton.tsx","components/TabBar.tsx","app/WelcomeDrawer.tsx","app/App.tsx","app/store.ts","serviceWorker.ts","index.tsx","utils/fetch.ts","features/user/userSlice.ts","features/feed/feedSlice.ts","app/styles.tsx","app/router.ts","features/feed/mocks.ts","features/submit/submitSlice.ts","features/feed/Post.tsx","components/Rating.tsx","utils/dom-utils.ts","components/Author.tsx","components/TimeAgo.tsx","features/feed/PostInfo.tsx","features/feed/DetailView.tsx"],"names":["UserState","DelayedFallback","useState","show","setShow","useEffect","timeout","setTimeout","clearTimeout","Spinner","label","AppRoute","children","lazyload","path","redirect","isLoggedIn","useSelector","selectIsLoggedIn","when","LoggedIn","LoggedOut","to","pathname","Component","fallback","Feed","category","dispatch","useDispatch","state","selectPostsByCategory","async","posts","error","loadRequested","loading","Object","keys","length","postsSortedByDate","values","sort","postA","postB","date","Box","display","gridTemplateColumns","gridGap","marginTop","map","post","Post","key","postID","Location","profile","selectOwnProfile","Text","as","fontWeight","textDecoration","cityName","FeedHeader","_props","React","modalIsOpen","setModalIsOpen","toast","useToast","responsiveBoxProps","color","fontSize","firstName","cursor","onClick","InputGroup","Icon","name","Input","maxWidth","onFocus","title","description","status","duration","isClosable","placeholder","type","Modal","isOpen","onClose","Button","variantColor","size","tabs","id","FeedPage","useLocation","previousPathname","usePrevious","widthPX","useWindowWidth","leading","wait","tabsSize","convertWidthToEM","Tabs","width","aria-controls","aria-selected","Link","tabIndex","outline","exact","render","props","DetailView","from","TabBarButton","ariaLabel","icon","isActive","alignItems","flexDirection","paddingY","IconButton","aria-label","variant","Submit","lazy","then","default","Profile","Account","Login","ResetPassword","Registration","Page404","buttons","home","submit","account","loggedInButtons","loggedOutButtons","TabBar","loggedIn","location","backgroundColor","borderTop","borderColor","bottom","position","zIndex","buttonProps","flex","startsWith","WelcomeDrawer","visible","Drawer","isFullHeight","placement","margin","padding","App","shouldShowDrawer","setShouldShowDrawer","value","localStorage","getItem","ThemeProvider","theme","CSSReset","basename","ROUTER_BASENAME","history","setItem","marginBottom","persistConfig","storage","blacklist","rootReducer","combineReducers","feed","feedReducer","submitReducer","user","userReducer","persistedReducer","persistReducer","store","configureStore","reducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","FLUSH","REHYDRATE","PAUSE","PERSIST","PURGE","REGISTER","persistStore","Boolean","window","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","console","message","DEFAULT_OPTIONS","credentials","headers","fetch","options","response","json","ok","Error","errorMessage","OPENED_OWN_PROFILE_PENDING","OPENED_OWN_PROFILE_FULFILLED","OPENED_OWN_PROFILE_REJECTED","MOCKED_OWN_PROFILE","email","lastName","postsCount","postIDs","rating","username","imageURL","PROFILE_IMAGE_OLIVER_MICKE","MOCKED_OTHER_PROFILES","emily_rose28","PROFILE_IMAGE_EMILY_ROSE28","createAsyncThunk","body","JSON","stringify","method","data","push","registered","openedOtherProfile","Promise","resolve","slice","createSlice","initialState","otherProfile","reducers","loggedOut","extraReducers","pending","fulfilled","_action","rejected","action","payload","thunks","requestedPostsOfUser","isOwnProfile","userNameParam","_getState","requestedPostsByIDs","actions","selectAsync","createSelector","selectOtherProfile","selectOwnUsername","MOCKED_CATEGORIES","postRequested","MOCKED_POSTS","reduce","acc","categories","advice","grocery","medical_supply","news","submitted","meta","arg","Date","image","text","userImageURL","forEach","c","categoryArg","normalizedPosts","assign","_state","selectPostByID","selectPostsByIDs","filter","includes","categoryState","marginX","chakraTheme","icons","ioMdEye","viewBox","ioMdEyeOff","mdAdd","mdHome","mdPerson","createHashHistory","generateRandomDate","start","now","end","getTime","Math","random","1","2","3","4","5","6","_body","paddingProps","FALLBACK_IMAGE_URL","detailViewRedirectToProfile","linkToDetailView","boxShadow","borderRadius","RouterLink","height","background","borderTopRightRadius","_hover","alt","borderTopLeftRadius","objectFit","src","style","shouldShowDescription","marginLeft","NOT_CONFIDENT","Rating","boxProps","labelProps","colorForRating","circularRating","role","trackColor","marginRight","descriptionForRating","parseFloat","getBodyFontSize","getComputedStyle","querySelector","ChakraLink","Author","profilePath","Avatar","TimeAgo","intervalType","seconds","floor","interval","timeSince","PostInfo","Divider","orientation","CATEGORY_NAMES","CATEGORY_LINKS","deviceSpecificProps","test","platform","maxTouchPoints","MSStream","useHistory","ownProfile","params","parseInt","nextPath","onVote","scrollBehavior","event","stopPropagation","maxHeight"],"mappings":"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","file":"static/js/main.c4911a35.chunk.js","sourcesContent":["import React, { FC, ReactElement, Suspense } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Redirect, Route } from 'react-router-dom';\n\nimport { DelayedFallback } from '../components/DelayedFallback';\n\nimport { selectIsLoggedIn } from '../features/user/userSlice';\n\nimport { AppRoutes } from './router';\n\nexport enum UserState {\n  LoggedIn,\n  LoggedOut,\n}\n\ntype Props = {\n  children: ReactElement;\n  lazyload: boolean;\n  path: AppRoutes | null;\n  redirect?: {\n    path: AppRoutes;\n    when: UserState;\n  };\n};\n\nexport const AppRoute: FC<Props> = ({ children, lazyload, path, redirect }: Props) => {\n  const isLoggedIn = useSelector(selectIsLoggedIn);\n  const shouldRedirect =\n    (redirect?.when === UserState.LoggedIn && isLoggedIn) || (redirect?.when === UserState.LoggedOut && !isLoggedIn);\n  if (shouldRedirect) {\n    return <Redirect to={{ pathname: redirect?.path }} />;\n  }\n\n  const Component = <Route path={path || ''}>{children}</Route>;\n  return lazyload ? <Suspense fallback={<DelayedFallback />}>{Component}</Suspense> : Component;\n};\n","import React, { FC, useEffect, useState } from 'react';\nimport { Spinner } from '@chakra-ui/core';\n\nexport const DelayedFallback: FC = () => {\n  const [show, setShow] = useState(false);\n\n  useEffect(() => {\n    const timeout = setTimeout(() => setShow(true), 500);\n    return (): void => {\n      clearTimeout(timeout);\n    };\n  }, []);\n\n  return <>{show && <Spinner label='Loading...' />}</>;\n};\n","import React, { FC, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Box } from '@chakra-ui/core';\n\nimport { Post } from './Post';\nimport { Category, loadRequested, Post as PostType, selectPostsByCategory } from './feedSlice';\n\nimport { RootState } from '../../app/store';\n\ntype Props = {\n  category: Category;\n};\n\nexport const Feed: FC<Props> = ({ category }: Props) => {\n  const dispatch = useDispatch();\n  const { async, posts } = useSelector((state: RootState) => selectPostsByCategory(state, category));\n\n  useEffect(() => {\n    if (async.error === null && posts === null) {\n      dispatch(loadRequested(category));\n    }\n  }, [async, category, dispatch, posts]);\n\n  if (async.error) {\n    // TODO:\n    return <h1>An error occured</h1>;\n  }\n\n  if (async.loading === 'pending') {\n    // TODO:\n    return <h1>Loading...</h1>;\n  }\n\n  if (posts === null) {\n    return <>TODO: Loading state</>;\n  }\n\n  if (Object.keys(posts).length === 0) {\n    return <>TODO: Empty state</>;\n  }\n\n  const postsSortedByDate = Object.values(posts).sort((postA, postB) => (postA.date > postB.date ? -1 : 1));\n\n  return (\n    <Box\n      display='grid'\n      gridTemplateColumns={['100%', 'repeat(2, 1fr)', 'repeat(3, 1fr)', 'repeat(4, 1fr)']}\n      gridGap={8}\n      marginTop={8}\n    >\n      {postsSortedByDate.map((post: PostType) => (\n        <Post key={post.postID} {...post} />\n      ))}\n    </Box>\n  );\n};\n","import React, { FC } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Link as RouterLink } from 'react-router-dom';\nimport {\n  Box,\n  Button,\n  Icon,\n  Input,\n  InputGroup,\n  InputLeftElement,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalFooter,\n  ModalHeader,\n  ModalOverlay,\n  Text,\n  useToast,\n} from '@chakra-ui/core';\n\nimport { selectOwnProfile } from '../user/userSlice';\n\nimport { responsiveBoxProps } from '../../app/styles';\n\nimport { AppRoutes } from '../../app/router';\n\ntype Props = {};\n\nconst INPUT_PLACEHOLDER = 'Use keywords to search for information';\n\nconst Location: FC<{}> = () => {\n  const profile = useSelector(selectOwnProfile).profile ?? null;\n\n  if (profile === null) {\n    return null;\n  }\n\n  return (\n    <Text as='a' fontWeight='semibold' textDecoration='underline'>\n      {profile.cityName}\n    </Text>\n  );\n};\n\nexport const FeedHeader: FC<Props> = (_props: Props) => {\n  const profile = useSelector(selectOwnProfile).profile ?? null;\n\n  const [modalIsOpen, setModalIsOpen] = React.useState(false);\n  const onModalClose = (): void => {\n    setModalIsOpen(false);\n  };\n\n  const toast = useToast();\n\n  if (!profile) {\n    return (\n      <Box {...responsiveBoxProps}>\n        <p>Sign in to vote and contribute.</p>\n        <RouterLink to={'/account/login' as AppRoutes}>\n          <Button marginTop={4} size='sm' variantColor='blue'>\n            Sign in\n          </Button>\n        </RouterLink>\n      </Box>\n    );\n  }\n\n  return (\n    <Box {...responsiveBoxProps}>\n      <Text color='gray.600' fontSize='lg'>\n        Good morning, {profile.firstName || profile.cityName}\n      </Text>\n      <Text\n        color='gray.600'\n        cursor='pointer'\n        fontSize='lg'\n        marginTop={1}\n        onClick={(): void => {\n          setModalIsOpen(true);\n        }}\n      >\n        Here are the latest for <Location />\n      </Text>\n      <InputGroup marginTop={4}>\n        <InputLeftElement>\n          <Icon color='gray.400' name='search' />\n        </InputLeftElement>\n        <Input\n          fontSize={['xs', 'sm', 'md']}\n          maxWidth={400}\n          onFocus={(): void => {\n            toast({\n              title: 'Not yet implemented',\n              description: 'This demo does not support searching posts yet.',\n              status: 'info',\n              duration: 7000,\n              isClosable: true,\n            });\n          }}\n          placeholder={INPUT_PLACEHOLDER}\n          type='text'\n        />\n      </InputGroup>\n\n      <Modal isOpen={modalIsOpen} onClose={onModalClose}>\n        <ModalOverlay />\n        <ModalContent>\n          <ModalHeader>Changing the feed&apos;s location</ModalHeader>\n          <ModalCloseButton />\n          <ModalBody>\n            <Text fontWeight='semibold'>Not yet implemented</Text>\n            <Text marginTop={4}>\n              Here you will be able to change the feed&apos;s location and see posts from all over the world. However,\n              creating posts and validating other posts is restricted to your location.\n            </Text>\n          </ModalBody>\n\n          <ModalFooter>\n            <Button\n              onClick={(): void => {\n                setModalIsOpen(false);\n              }}\n              variantColor='blue'\n            >\n              OK\n            </Button>\n          </ModalFooter>\n        </ModalContent>\n      </Modal>\n    </Box>\n  );\n};\n","import React, { FC } from 'react';\nimport { Link, Redirect, Route, Switch, useLocation } from 'react-router-dom';\nimport { Box, Tab, TabList, TabPanels, Tabs, usePrevious } from '@chakra-ui/core';\nimport { useWindowWidth } from '@react-hook/window-size';\n\nimport { DetailView } from './DetailView';\nimport { Feed } from './Feed';\nimport { FeedHeader } from './FeedHeader';\n\nimport { Category } from './feedSlice';\n\nimport { responsiveBoxProps } from '../../app/styles';\n\nimport { convertWidthToEM } from '../../utils/dom-utils';\n\nconst ARIA_TABS = 'tabs';\nconst ARIA_NEWS_TAB = 'tabs-news-tab';\nconst ARIA_MEDICAL_SUPPLY_TAB = 'tabs-medical-supply-tab';\nconst ARIA_GROCERY_TAB = 'tabs-grocery-tab';\nconst ARIA_ADVICE_TAB = 'tabs-advice-tab';\n\nconst NEWS_PATH = '/feed/news';\nconst MEDICAL_SUPPLY_PATH = '/feed/medical-supply';\nconst GROCERY_PATH = '/feed/grocery';\nconst ADVICE_PATH = '/feed/advice';\n\nconst tabs: {\n  category: Category;\n  id: string;\n  name: string;\n  to: string;\n}[] = [\n  { category: 'news', id: ARIA_NEWS_TAB, name: 'News', to: NEWS_PATH },\n  { category: 'medical_supply', id: ARIA_MEDICAL_SUPPLY_TAB, name: 'Medical Supply', to: MEDICAL_SUPPLY_PATH },\n  { category: 'grocery', id: ARIA_GROCERY_TAB, name: 'Grocery', to: GROCERY_PATH },\n  { category: 'advice', id: ARIA_ADVICE_TAB, name: 'Advice', to: ADVICE_PATH },\n];\n\n// Taken from theme.breakpoints\nconst TABS_SIZE_BREAKPOINT_EM = 30;\n\nexport const FeedPage: FC = () => {\n  const { pathname } = useLocation();\n  const previousPathname = usePrevious(pathname);\n\n  // Workaround for showing smaller text on mobile.\n  const widthPX = useWindowWidth(0, { leading: true, wait: 250 });\n  const widthEM = convertWidthToEM(widthPX);\n  const tabsSize = widthEM <= TABS_SIZE_BREAKPOINT_EM ? 'sm' : 'md';\n\n  return (\n    <Box marginTop={2}>\n      <FeedHeader />\n      <Tabs marginTop={[6, 6, 8]} size={tabsSize}>\n        <TabList id={ARIA_TABS} {...responsiveBoxProps} width={['100%', '100%', '90%', '80%', '70%']}>\n          {tabs.map(({ id, name, to }) => (\n            <Tab\n              aria-controls={ARIA_TABS}\n              aria-selected={pathname === to}\n              as={Link}\n              id={id}\n              key={name}\n              tabIndex={0}\n              to={to}\n            >\n              {name}\n            </Tab>\n          ))}\n        </TabList>\n\n        <TabPanels marginTop={8} outline='none' {...responsiveBoxProps}>\n          <Switch>\n            {tabs.map(({ category, to }) => (\n              <Route exact key={category} path={to}>\n                <Feed category={category} />\n              </Route>\n            ))}\n            <Route\n              path='/feed/detail/:postID'\n              render={(props): JSX.Element => <DetailView {...props} previousPathname={previousPathname} />}\n            ></Route>\n            <Redirect from='/' to={NEWS_PATH} />\n          </Switch>\n        </TabPanels>\n      </Tabs>\n    </Box>\n  );\n};\n","import React, { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Box, IconButton, IconButtonProps, Text } from '@chakra-ui/core';\n\nimport { ThemeType } from '../app/styles';\n\ntype Props = {\n  ariaLabel: IconButtonProps['aria-label'];\n  icon: keyof ThemeType['icons'];\n  isActive: boolean;\n  name: string;\n  to: string;\n};\n\nexport const TabBarButton: FC<Props> = ({ ariaLabel, icon, isActive, name, to }: Props) => (\n  <Link to={to}>\n    <Box alignItems='center' display='flex' flexDirection='column' paddingY={2}>\n      <IconButton\n        aria-label={ariaLabel}\n        as='span'\n        // @ts-ignore\n        icon={icon}\n        isActive={isActive}\n        size='md'\n        variant='link'\n        variantColor='gray'\n      />\n      <Text as='span' color={isActive ? 'black' : 'gray.600'} fontSize='sm'>\n        {name}\n      </Text>\n    </Box>\n  </Link>\n);\n","import React, { FC, lazy } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Redirect, Switch, useLocation } from 'react-router-dom';\nimport { Box } from '@chakra-ui/core';\n\nimport { AppRoute, UserState } from '../app/AppRoute';\nimport { FeedPage } from '../features/feed/FeedPage';\nimport { TabBarButton } from './TabBarButton';\n\nimport { selectIsLoggedIn } from '../features/user/userSlice';\n\nimport { AppRoutes } from '../app/router';\nimport { ThemeType } from '../app/styles';\n\nconst Submit = lazy(() =>\n  import('../features/submit/Submit').then(({ Submit }) => ({\n    default: Submit,\n  })),\n);\n\nconst Profile = lazy(() =>\n  import('../features/user/Profile').then(({ Profile }) => ({\n    default: Profile,\n  })),\n);\n\nconst Account = lazy(() =>\n  import('../features/user/Account').then(({ Account }) => ({\n    default: Account,\n  })),\n);\n\nconst Login = lazy(() =>\n  import('../features/user/Login').then(({ Login }) => ({\n    default: Login,\n  })),\n);\n\nconst ResetPassword = lazy(() =>\n  import('../features/user/ResetPassword').then(({ ResetPassword }) => ({\n    default: ResetPassword,\n  })),\n);\n\nconst Registration = lazy(() =>\n  import('../features/user/Registration').then(({ Registration }) => ({\n    default: Registration,\n  })),\n);\n\nconst Page404 = lazy(() =>\n  import('./Page404').then(({ Page404 }) => ({\n    default: Page404,\n  })),\n);\n\nconst buttons: {\n  [key: string]: {\n    ariaLabel: string;\n    icon: keyof ThemeType['icons'];\n    name: string;\n    to: AppRoutes;\n  };\n} = {\n  home: { ariaLabel: 'home button', icon: 'mdHome', name: 'Home', to: '/feed' },\n  submit: { ariaLabel: 'submit button', icon: 'mdAdd', name: 'Submit', to: '/submit' },\n  profile: { ariaLabel: 'profile button', icon: 'mdPerson', name: 'Profile', to: '/profile/me' },\n  account: { ariaLabel: 'account button', icon: 'mdPerson', name: 'Account', to: '/account' },\n};\n\nconst loggedInButtons = {\n  home: buttons.home,\n  submit: buttons.submit,\n  profile: buttons.profile,\n};\n\nconst loggedOutButtons = {\n  home: buttons.home,\n  submit: buttons.submit,\n  account: buttons.account,\n};\n\nconst getButtons = (loggedIn: boolean): typeof buttons[number][] =>\n  Object.values(loggedIn ? loggedInButtons : loggedOutButtons);\n\nexport const TabBar: FC<{}> = () => {\n  const location = useLocation();\n  const isLoggedIn = useSelector(selectIsLoggedIn);\n\n  const buttons = getButtons(isLoggedIn);\n\n  return (\n    <>\n      <Switch>\n        <AppRoute lazyload={false} path='/feed'>\n          <FeedPage />\n        </AppRoute>\n        <AppRoute lazyload path='/submit'>\n          <Submit />\n        </AppRoute>\n        <AppRoute\n          lazyload\n          path='/profile/me'\n          redirect={{\n            path: '/account',\n            when: UserState.LoggedOut,\n          }}\n        >\n          <Profile />\n        </AppRoute>\n        <AppRoute\n          lazyload\n          path='/account/reset-password'\n          redirect={{\n            path: '/profile/me',\n            when: UserState.LoggedIn,\n          }}\n        >\n          <ResetPassword />\n        </AppRoute>\n        <AppRoute\n          lazyload\n          path='/account/login'\n          redirect={{\n            path: '/profile/me',\n            when: UserState.LoggedIn,\n          }}\n        >\n          <Login />\n        </AppRoute>\n        <AppRoute\n          lazyload\n          path='/account/register'\n          redirect={{\n            path: '/profile/me',\n            when: UserState.LoggedIn,\n          }}\n        >\n          <Registration />\n        </AppRoute>\n        <AppRoute\n          lazyload\n          path='/account'\n          redirect={{\n            path: '/profile/me',\n            when: UserState.LoggedIn,\n          }}\n        >\n          <Account />\n        </AppRoute>\n        <Redirect exact from='/profile' to={'/profile/me' as AppRoutes} />\n        <AppRoute lazyload path='/profile'>\n          <Profile />\n        </AppRoute>\n        <Redirect exact from='/' to={'/feed' as AppRoutes} />\n        <AppRoute lazyload path={null}>\n          <Page404 />\n        </AppRoute>\n      </Switch>\n\n      <nav>\n        <Box\n          backgroundColor='white'\n          borderTop='1px solid'\n          borderColor='gray.300'\n          bottom='0'\n          display='flex'\n          position='fixed'\n          width='100%'\n          zIndex={1}\n        >\n          {buttons.map((buttonProps) => (\n            <Box flex='1 1 0' key={buttonProps.name}>\n              <TabBarButton {...buttonProps} isActive={location.pathname.startsWith(buttonProps.to)} />\n            </Box>\n          ))}\n        </Box>\n      </nav>\n    </>\n  );\n};\n","import React, { FC } from 'react';\nimport {\n  Button,\n  Drawer,\n  DrawerBody,\n  DrawerFooter,\n  DrawerHeader,\n  DrawerOverlay,\n  DrawerContent,\n  DrawerCloseButton,\n  Text,\n} from '@chakra-ui/core';\n\ntype Props = {\n  onClose: () => void;\n  visible: boolean;\n};\n\nexport const WelcomeDrawer: FC<Props> = ({ onClose, visible }: Props) => (\n  <Drawer isOpen={visible} isFullHeight placement='top' onClose={onClose}>\n    <DrawerOverlay />\n    <DrawerContent>\n      <DrawerCloseButton />\n      <DrawerHeader margin={['inherit', 'inherit', '0 auto']} maxWidth={500}>\n        Welcome to Trusted Locals!\n      </DrawerHeader>\n\n      <DrawerBody margin='0 auto' maxWidth={500}>\n        <Button onClick={onClose} padding={0} variant='ghost' variantColor='blue'>\n          Show the demo\n        </Button>\n        <Text marginTop={8} fontSize={16} fontWeight='semibold'>\n          About\n        </Text>\n        <Text>\n          Trusted Locals is a platform built for finding reliable on-site information in times of crisis. With Trusted\n          Locals you can avoid the chaos of social media content that is duplicate, irrelevant, and uncategorized.\n        </Text>\n        <Text marginTop={8} fontSize={16} fontWeight='semibold'>\n          Disclaimer\n        </Text>\n        <Text>\n          In this demo, you will be logged in with the profile of one of our developers. None of your votes or created\n          posts will be saved. The posts you see are made up, and should not be taken seriously.\n        </Text>\n      </DrawerBody>\n\n      <DrawerFooter margin={['inherit', 'inherit', '0 auto']} maxWidth={500}>\n        <Button onClick={onClose} variantColor='blue'>\n          Show the demo\n        </Button>\n      </DrawerFooter>\n    </DrawerContent>\n  </Drawer>\n);\n","import React, { FC, useEffect, useState } from 'react';\nimport { HashRouter, Router } from 'react-router-dom';\nimport { Box, CSSReset, ThemeProvider } from '@chakra-ui/core';\n\nimport { TabBar } from '../components/TabBar';\n\nimport { WelcomeDrawer } from './WelcomeDrawer';\n\nimport { history, ROUTER_BASENAME } from './router';\nimport { theme } from './styles';\n\nconst DID_SEE_WELCOME_DRAWER_KEY = 'did-see-welcome-drawer-01';\n\nexport const App: FC = () => {\n  const [shouldShowDrawer, setShouldShowDrawer] = useState(false);\n\n  const onWelcomeDrawerClose = (): void => {\n    localStorage.setItem(DID_SEE_WELCOME_DRAWER_KEY, 'true');\n    setShouldShowDrawer(false);\n  };\n\n  useEffect((): void => {\n    const value = localStorage.getItem(DID_SEE_WELCOME_DRAWER_KEY);\n    setShouldShowDrawer(value !== 'true');\n  }, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CSSReset />\n      <HashRouter basename={ROUTER_BASENAME}>\n        <Router history={history}>\n          <WelcomeDrawer onClose={onWelcomeDrawerClose} visible={shouldShowDrawer} />\n          <Box marginBottom={24}>\n            <TabBar />\n          </Box>\n        </Router>\n      </HashRouter>\n    </ThemeProvider>\n  );\n};\n","import { combineReducers, configureStore, getDefaultMiddleware } from '@reduxjs/toolkit';\nimport { persistReducer, persistStore, FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage';\n\nimport { feedReducer } from '../features/feed/feedSlice';\nimport { submitReducer } from '../features/submit/submitSlice';\nimport { userReducer } from '../features/user/userSlice';\n\nexport type AppDispatch = typeof store.dispatch;\n\nexport type RootState = ReturnType<typeof rootReducer>;\n\nconst persistConfig = {\n  key: 'root',\n  storage,\n  // TODO: Preliminary\n  blacklist: ['profile', 'submit', 'user'],\n};\n\nconst rootReducer = combineReducers({\n  feed: feedReducer,\n  submit: submitReducer,\n  user: userReducer,\n});\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\n\nexport const store = configureStore({\n  reducer: persistedReducer,\n  middleware: getDefaultMiddleware({\n    serializableCheck: {\n      ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER],\n    },\n  }),\n});\n\nexport const persistor = persistStore(store);\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React, { StrictMode } from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './app/App';\nimport { store } from './app/store';\nimport { Provider } from 'react-redux';\nimport { unregister } from './serviceWorker';\n\nReactDOM.render(\n  <StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </StrictMode>,\n  document.getElementById('root'),\n);\n\n// Preliminary\nunregister();\n","const DEFAULT_OPTIONS: Parameters<typeof window.fetch>[1] = {\n  credentials: 'include',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n};\n\nconst ENDPOINT_URL =\n  process.env.NODE_ENV === 'production' ? 'https://ec2-54-89-76-249.compute-1.amazonaws.com' : 'http://localhost:8080';\n\nexport function fetch<D>(path: string, options?: object): Promise<D> {\n  return window\n    .fetch(ENDPOINT_URL + path, {\n      ...DEFAULT_OPTIONS,\n      ...options,\n    })\n    .then((response: Response) => {\n      return response.json().then((json) => {\n        if (response.ok) {\n          return json;\n        }\n\n        throw json;\n      });\n    })\n    .catch((error) => {\n      throw new Error(error.errorMessage || 'An unknown error has occured.');\n    });\n}\n","import { createAsyncThunk, createSelector, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { fetch } from '../../utils/fetch';\n\nimport { AppRoutes, history } from '../../app/router';\nimport { AppDispatch, RootState } from '../../app/store';\n\nimport { PROFILE_IMAGE_EMILY_ROSE28, PROFILE_IMAGE_OLIVER_MICKE } from '../feed/mocks';\n\nimport { Post, requestedPostsByIDs } from '../feed/feedSlice';\n\nconst SLICE_NAME = 'user';\n\ntype AsyncState = {\n  error: string | null;\n  loading: 'idle' | 'pending';\n};\n\nexport type Profile = {\n  cityName: string;\n  email: string;\n  firstName?: string;\n  lastName?: string;\n  postsCount: number;\n  postIDs: Post['postID'][];\n  rating: number;\n  username: string;\n  imageURL?: string;\n};\n\nexport type OtherProfile = {\n  cityName: string;\n  firstName?: string;\n  lastName?: string;\n  postsCount: number;\n  postIDs: Post['postID'][];\n  rating: number;\n  username: string;\n  imageURL?: string;\n};\n\ntype State = {\n  async: AsyncState;\n  isLoggedIn: boolean;\n  profile: {\n    async: AsyncState;\n    profile: Profile | null;\n  };\n  otherProfile: {\n    async: AsyncState;\n    profile: OtherProfile | null;\n  };\n};\n\ntype LoginBody = {\n  name: string;\n  password: string;\n};\n\ntype LoginSuccess = {\n  success: boolean;\n  token: string;\n};\n\ntype RegistrationBody = {\n  country: string;\n  email: string;\n  name: string;\n  password: string;\n};\n\ntype RegistrationSuccess = {\n  success: boolean;\n  token: string;\n};\n\ntype OpenedOtherProfileBody = {\n  username: string;\n};\n\ntype OpenedOtherProfileSuccess = OtherProfile;\n\nconst OPENED_OWN_PROFILE_PENDING = `${SLICE_NAME}/ownProfile/pending`;\nconst OPENED_OWN_PROFILE_FULFILLED = `${SLICE_NAME}/ownProfile/fulfilled`;\nconst OPENED_OWN_PROFILE_REJECTED = `${SLICE_NAME}/ownProfile/rejected`;\n\nconst MOCKED_OWN_PROFILE: Profile = {\n  cityName: 'Richmond',\n  email: 'foo@bar.com',\n  firstName: 'Oliver',\n  lastName: 'Micke',\n  postsCount: 4,\n  postIDs: [1, 3, 4, 5],\n  rating: 49,\n  username: 'olivermicke',\n  imageURL: PROFILE_IMAGE_OLIVER_MICKE,\n};\n\nconst MOCKED_OTHER_PROFILES: { [key: string]: OtherProfile } = {\n  emily_rose28: {\n    cityName: 'Richmond',\n    rating: 78,\n    postsCount: 2,\n    postIDs: [2, 6],\n    username: 'emily_rose28',\n    imageURL: PROFILE_IMAGE_EMILY_ROSE28,\n  },\n};\n\nexport const loggedIn = createAsyncThunk(`${SLICE_NAME}/loggedIn`, (body: LoginBody) =>\n  fetch<LoginSuccess>('/user/login', {\n    body: JSON.stringify(body),\n    method: 'POST',\n  }).then((data) => {\n    history.push('/feed' as AppRoutes);\n    return data;\n  }),\n);\n\nexport const registered = createAsyncThunk(`${SLICE_NAME}/registered`, (body: RegistrationBody) =>\n  fetch<RegistrationSuccess>('/user', {\n    body: JSON.stringify(body),\n    method: 'POST',\n  }).then((data) => {\n    history.push('/feed' as AppRoutes);\n    return data;\n  }),\n);\n\nexport const openedOtherProfile = createAsyncThunk(\n  `${SLICE_NAME}/openedOtherProfile`,\n  ({ username }: OpenedOtherProfileBody) => Promise.resolve(MOCKED_OTHER_PROFILES[username]),\n);\n\nexport const slice = createSlice({\n  name: SLICE_NAME,\n  initialState: {\n    async: {\n      error: null,\n      loading: 'idle',\n    },\n    // Preliminary\n    isLoggedIn: true,\n    profile: {\n      async: {\n        error: null,\n        loading: 'idle',\n      },\n      profile: MOCKED_OWN_PROFILE,\n    },\n    otherProfile: {\n      async: {\n        error: null,\n        loading: 'idle',\n      },\n      profile: null,\n    },\n  } as State,\n  reducers: {\n    loggedOut: (state): void => {\n      state.profile.profile = null;\n      state.isLoggedIn = false;\n    },\n  },\n  extraReducers: {\n    [loggedIn.pending.type]: (state): void => {\n      if (state.async.loading === 'idle') {\n        state.async.loading = 'pending';\n      }\n    },\n    [loggedIn.fulfilled.type]: (state, _action: PayloadAction<LoginSuccess>): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n        state.isLoggedIn = true;\n        // TODO: Receive profile data from BE\n        state.profile = {\n          async: {\n            error: null,\n            loading: 'idle',\n          },\n          profile: MOCKED_OWN_PROFILE,\n        };\n      }\n    },\n    [loggedIn.rejected.type]: (state, action: { error: Error }): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n        state.async.error = action.error.message;\n      }\n    },\n    [registered.pending.type]: (state): void => {\n      if (state.async.loading === 'idle') {\n        state.async.loading = 'pending';\n      }\n    },\n    [registered.fulfilled.type]: (state, _action: PayloadAction<RegistrationSuccess>): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n        state.isLoggedIn = true;\n        // TODO: Receive profile data from BE\n        state.profile.profile = MOCKED_OWN_PROFILE;\n      }\n    },\n    [registered.rejected.type]: (state, action: { error: Error }): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n        state.async.error = action.error.message;\n      }\n    },\n    [openedOtherProfile.pending.type]: (state): void => {\n      state.otherProfile.async.error = null;\n      state.otherProfile.async.loading = 'pending';\n    },\n    [openedOtherProfile.fulfilled.type]: (state, action: PayloadAction<OpenedOtherProfileSuccess>): void => {\n      state.otherProfile.async.loading = 'idle';\n      state.otherProfile.profile = action.payload;\n    },\n    [openedOtherProfile.rejected.type]: (state, action: { error: Error }): void => {\n      state.otherProfile.async.loading = 'idle';\n      state.otherProfile.async.error = action.error.message;\n    },\n    [OPENED_OWN_PROFILE_PENDING]: (state): void => {\n      state.profile.async.error = null;\n      state.profile.async.loading = 'pending';\n    },\n    [OPENED_OWN_PROFILE_FULFILLED]: (state, action: PayloadAction<{ profile: Profile }>): void => {\n      state.profile.async.loading = 'idle';\n      state.profile.profile = action.payload.profile;\n    },\n    [OPENED_OWN_PROFILE_REJECTED]: (state, action: { error: Error }): void => {\n      state.profile.async.loading = 'idle';\n      state.profile.async.error = action.error.message;\n    },\n  },\n});\n\nconst thunks = {\n  requestedPostsOfUser: function ({ isOwnProfile, userNameParam }: { isOwnProfile: boolean; userNameParam: string }) {\n    return (dispatch: AppDispatch, _getState: () => RootState): void => {\n      Promise.resolve({ profile: isOwnProfile ? MOCKED_OWN_PROFILE : MOCKED_OTHER_PROFILES[userNameParam] })\n        .then(({ profile }) => {\n          dispatch(requestedPostsByIDs(profile.postIDs));\n\n          dispatch({\n            type: OPENED_OWN_PROFILE_FULFILLED,\n            payload: {\n              profile,\n            },\n          });\n        })\n        .catch((error: Error) => {\n          dispatch({ error, type: OPENED_OWN_PROFILE_REJECTED });\n        });\n    };\n  },\n};\n\nexport const { loggedOut, requestedPostsOfUser } = { ...slice.actions, ...thunks };\n\nexport const selectAsync = (state: RootState): State['async'] =>\n  createSelector(\n    (state: RootState) => state.user.async,\n    (async) => async,\n  )(state);\n\nexport const selectIsLoggedIn = (state: RootState): State['isLoggedIn'] =>\n  createSelector(\n    (state: RootState) => state.user.isLoggedIn,\n    (isLoggedIn) => isLoggedIn,\n  )(state);\n\nexport const selectOtherProfile = (state: RootState): State['otherProfile'] =>\n  createSelector(\n    (state: RootState) => state.user.otherProfile,\n    (otherProfile) => otherProfile,\n  )(state);\n\nexport const selectOwnProfile = (state: RootState): State['profile'] =>\n  createSelector(\n    (state: RootState) => state.user.profile,\n    (profile) => profile,\n  )(state);\n\nexport const selectOwnUsername = (state: RootState): string | null =>\n  createSelector(\n    (state: RootState) => {\n      if (!state.user.profile || !state.user.profile.profile) {\n        return null;\n      }\n\n      return state.user.profile.profile.username;\n    },\n    (username) => username,\n  )(state);\n\nexport const userReducer = slice.reducer;\n","import { createAsyncThunk, createSelector, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { RootState } from '../../app/store';\n\nimport { MOCKED_CATEGORIES, MOCKED_POSTS } from './mocks';\n\nimport { submitted, SubmitBody } from '../submit/submitSlice';\n\nconst SLICE_NAME = 'feed';\n\ntype AsyncState = {\n  error: string | null;\n  loading: 'idle' | 'pending';\n};\n\nexport type Category = 'news' | 'medical_supply' | 'grocery' | 'advice';\n\nexport type Post = {\n  postID: number;\n  categories: Category[];\n  date: number;\n  imageURL: string | null;\n  rating: number | null;\n  text: string;\n  title: string;\n  userImageURL: string | null;\n  username: string;\n};\n\nexport type Posts = { [key in Post['postID']]: Post };\n\nexport type Categories = { [key in Category]: { async: AsyncState; postIDs: number[] | null } };\n\ntype State = {\n  categories: Categories;\n  posts: {\n    [key in Post['postID']]: {\n      async: AsyncState;\n      post: Post | null;\n    };\n  };\n};\n\nexport const loadRequested = createAsyncThunk(`${SLICE_NAME}/loadRequested`, (category: Category) =>\n  Promise.resolve({ posts: MOCKED_CATEGORIES[category] }),\n);\n\nexport const postRequested = createAsyncThunk(`${SLICE_NAME}/postRequested`, (postID: Post['postID']) =>\n  Promise.resolve({ post: MOCKED_POSTS[postID] }),\n);\n\nexport const requestedPostsByIDs = createAsyncThunk(`${SLICE_NAME}/requestedPostsByIDs`, (postIDs: Post['postID'][]) =>\n  Promise.resolve({\n    posts: postIDs.reduce(\n      (acc, postID) => ({\n        ...acc,\n        [postID]: MOCKED_POSTS[postID],\n      }),\n      {},\n    ),\n  }),\n);\n\nconst initialState: State = {\n  categories: {\n    advice: {\n      async: { error: null, loading: 'idle' },\n      postIDs: null,\n    },\n    grocery: {\n      async: { error: null, loading: 'idle' },\n      postIDs: null,\n    },\n    medical_supply: {\n      async: { error: null, loading: 'idle' },\n      postIDs: null,\n    },\n    news: {\n      async: { error: null, loading: 'idle' },\n      postIDs: null,\n    },\n  },\n  posts: {},\n};\n\nexport const slice = createSlice({\n  name: SLICE_NAME,\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [submitted.fulfilled.type]: (state, action: any): void => {\n      const body: SubmitBody = action.meta.arg;\n      const post: Post = {\n        categories: body.categories,\n        date: +new Date(),\n        imageURL: body.image,\n        postID: Object.values(state.posts)?.length + 1 ?? 1,\n        rating: null,\n        text: body.text,\n        title: body.title,\n        userImageURL: body.userImageURL,\n        username: body.username || '',\n      };\n\n      state.posts[post.postID] = {\n        async: { error: null, loading: 'idle' },\n        post,\n      };\n      post.categories.forEach((category) => {\n        const c = state.categories[category];\n        if (c.postIDs) {\n          c.postIDs.push(post.postID);\n        } else {\n          c.postIDs = [post.postID];\n        }\n      });\n    },\n    [loadRequested.pending.type]: (state, action): void => {\n      // @ts-ignore\n      const category: Category = action.meta.arg;\n\n      const async = state.categories[category].async;\n      async.loading = 'pending';\n    },\n    [loadRequested.fulfilled.type]: (state, action: PayloadAction<{ posts: Posts }>): void => {\n      // @ts-ignore\n      const categoryArg: Category = action.meta.arg;\n      const category = state.categories[categoryArg];\n\n      category.async.error = null;\n      category.async.loading = 'idle';\n      category.postIDs = Object.values(action.payload.posts).map((post) => post.postID);\n\n      const normalizedPosts = Object.values(action.payload.posts).reduce(\n        (acc, post) => ({\n          ...acc,\n          [post.postID]: {\n            async: {\n              error: null,\n              loading: 'idle',\n            },\n            post,\n          },\n        }),\n        {},\n      );\n\n      Object.assign(state.posts, normalizedPosts);\n    },\n    [loadRequested.rejected.type]: (state, action: { error: Error }): void => {\n      // @ts-ignore\n      const category: Category = action.meta.arg;\n\n      const async = state.categories[category].async;\n      async.loading = 'idle';\n      async.error = action.error.message;\n    },\n    [postRequested.pending.type]: (state, action): void => {\n      // @ts-ignore\n      const postID: Post['postID'] = action.meta.arg;\n\n      const post = state.posts[postID] ?? { async: {} };\n      post.async.loading = 'pending';\n      state.posts[postID] = post;\n    },\n    [postRequested.fulfilled.type]: (state, action: PayloadAction<{ post: Post }>): void => {\n      // @ts-ignore\n      const postID: Post['postID'] = action.meta.arg;\n      const post = state.posts[postID];\n\n      post.async.error = null;\n      post.async.loading = 'idle';\n\n      post.post = action.payload.post;\n    },\n    [postRequested.rejected.type]: (state, action: { error: Error }): void => {\n      // @ts-ignore\n      const postID: Post['postID'] = action.meta.arg;\n\n      const post = state.posts[postID] ?? {};\n      post.async = {\n        error: action.error.message,\n        loading: 'idle',\n      };\n      post.post = null;\n      state.posts[postID] = post;\n    },\n    // eslint-disable-next-line\n    [requestedPostsByIDs.pending.type]: (_state, _action): void => {},\n    [requestedPostsByIDs.fulfilled.type]: (state, action: PayloadAction<{ posts: Posts }>): void => {\n      // NOTE: Copied from above. Refactor.\n\n      const normalizedPosts = Object.values(action.payload.posts).reduce(\n        (acc, post) => ({\n          ...acc,\n          [post.postID]: {\n            async: {\n              error: null,\n              loading: 'idle',\n            },\n            post,\n          },\n        }),\n        {},\n      );\n\n      Object.assign(state.posts, normalizedPosts);\n    },\n    // eslint-disable-next-line\n    [requestedPostsByIDs.rejected.type]: (_state, _action: { error: Error }): void => {},\n  },\n});\n\nexport const selectPostByID = (state: RootState, postID: number): State['posts'][Post['postID']] | null =>\n  createSelector(\n    (state: RootState) => state.feed.posts[postID] ?? null,\n    (post) => post,\n  )(state);\n\nexport const selectPostsByIDs = (state: RootState, postIDs: number[]): State['posts'] =>\n  createSelector(\n    (state: RootState) =>\n      postIDs\n        .map((postID) => state.feed.posts[postID] ?? null)\n        .filter(Boolean)\n        .reduce(\n          (acc, post) => ({\n            ...acc,\n            [post.post?.postID as number]: post,\n          }),\n          {},\n        ),\n    (post) => post,\n  )(state);\n\nexport const selectPostsByCategory = (\n  state: RootState,\n  category: Category,\n): {\n  async: AsyncState;\n  posts: Posts | null;\n} =>\n  createSelector(\n    (state: RootState) => {\n      const postIDs = state.feed.categories[category].postIDs;\n\n      const posts =\n        postIDs === null\n          ? null\n          : Object.values(state.feed.posts).reduce((posts: Posts, { post }) => {\n              if (post === null || !postIDs.includes(post.postID)) {\n                return posts;\n              }\n\n              return {\n                ...posts,\n                [post.postID]: post,\n              };\n            }, {});\n\n      return {\n        async: state.feed.categories[category].async,\n        posts,\n      };\n    },\n    (categoryState) => categoryState,\n  )(state);\n\nexport const feedReducer = slice.reducer;\n","import React from 'react';\nimport { MdAdd, MdHome, MdPerson } from 'react-icons/md';\nimport { IoMdEye, IoMdEyeOff } from 'react-icons/io';\nimport { BoxProps, DefaultTheme, theme as chakraTheme } from '@chakra-ui/core';\n\nexport const responsiveBoxProps: BoxProps = {\n  marginTop: [4, 4, 8],\n  marginX: 'auto',\n  width: [\n    '80%', // base\n    '90%', // 480px upwards\n    '90%', // 768px upwards\n    '80%', // 992px upwards\n    '70%',\n  ],\n};\n\nexport type ThemeType = DefaultTheme & {\n  icons: DefaultTheme['icons'];\n};\n\nconst VIEW_BOX = '0 0 16 16';\n\nexport const theme: ThemeType = {\n  ...chakraTheme,\n  icons: {\n    ...chakraTheme.icons,\n    ioMdEye: {\n      path: <IoMdEye />,\n      viewBox: VIEW_BOX,\n    },\n    ioMdEyeOff: {\n      path: <IoMdEyeOff />,\n      viewBox: VIEW_BOX,\n    },\n    mdAdd: {\n      path: <MdAdd />,\n      viewBox: VIEW_BOX,\n    },\n    mdHome: {\n      path: <MdHome />,\n      viewBox: VIEW_BOX,\n    },\n    mdPerson: {\n      path: <MdPerson />,\n      viewBox: VIEW_BOX,\n    },\n  },\n};\n","import { createHashHistory } from 'history';\n\nexport const ROUTER_BASENAME = '/';\n\nexport const history = createHashHistory({ basename: ROUTER_BASENAME });\n\nexport type AppRoutes =\n  | '/'\n  | '/account'\n  | '/account/login'\n  | '/account/register'\n  | '/account/reset-password'\n  | '/feed'\n  | '/profile'\n  | '/profile/me'\n  | '/submit';\n","import { Category, Post } from './feedSlice';\n\nexport const PROFILE_IMAGE_OLIVER_MICKE = process.env.PUBLIC_URL + '/img/oliver-micke.jpg';\nexport const PROFILE_IMAGE_EMILY_ROSE28 =\n  'https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=60';\n\n// https://stackoverflow.com/questions/9035627/elegant-method-to-generate-array-of-random-dates-within-two-dates/9035732#9035732\nconst generateRandomDate = (start = new Date(Date.now() - 100000000), end = new Date()): number =>\n  +new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));\n\nexport const MOCKED_POSTS: { [postID in Post['postID']]: Post } = {\n  1: {\n    categories: ['news'] as Category[],\n    date: generateRandomDate(),\n    postID: 1,\n    rating: 23,\n    text: 'Lorem ipsum dolor sit amet.',\n    title: 'VCU Developed CODVID-19 test',\n    username: 'olivermicke',\n    imageURL:\n      'https://images.unsplash.com/photo-1511174511562-5f7f18b874f8?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_OLIVER_MICKE,\n  },\n  2: {\n    categories: ['grocery'] as Category[],\n    date: generateRandomDate(),\n    postID: 2,\n    rating: 72,\n    text:\n      'We will have a limited supply of toilet paper at Target on Broad street for the next days – source: I work there.',\n    title: 'Limited supply of toilet paper at Target on Broad street',\n    username: 'emily_rose28',\n    imageURL:\n      'https://images.unsplash.com/photo-1584556812952-905ffd0c611a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_EMILY_ROSE28,\n  },\n  3: {\n    categories: ['news', 'medical_supply'] as Category[],\n    date: generateRandomDate(),\n    postID: 3,\n    rating: 74,\n    text:\n      'Found some N95 masks available in the home depot in Henrico. I saw at least 3 boxes when I was there at around 9:30 AM',\n    title: 'N95 masks available again in Home Depot in Henrico',\n    username: 'olivermicke',\n    imageURL:\n      'https://images.unsplash.com/photo-1584462198614-03c2a523945d?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_OLIVER_MICKE,\n  },\n  4: {\n    categories: ['advice'] as Category[],\n    date: generateRandomDate(),\n    postID: 4,\n    rating: 44,\n    text: \"Especially in areas with community-spread, it's recommended to wear face masks whenever possible.\",\n    title: 'CDC recommends to wear face masks',\n    username: 'olivermicke',\n    imageURL:\n      'https://images.unsplash.com/photo-1582795003154-35736cf26353?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_OLIVER_MICKE,\n  },\n  5: {\n    categories: ['news', 'grocery'] as Category[],\n    date: generateRandomDate(),\n    postID: 5,\n    rating: 54,\n    text:\n      'A friend of mine just told me that toilet paper production was ramped up to keep up with the incresed demand.',\n    title: 'Toilet paper production ramping up',\n    username: 'olivermicke',\n    imageURL:\n      'https://images.unsplash.com/photo-1583541988180-fdf816b632e6?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_OLIVER_MICKE,\n  },\n  6: {\n    categories: ['news'] as Category[],\n    date: generateRandomDate(),\n    postID: 6,\n    rating: 84,\n    text: 'Service disconnection has just been suspended!',\n    title: 'Service disconnection has been suspended',\n    username: 'emily_rose28',\n    imageURL:\n      'https://images.unsplash.com/uploads/141086319550951a179e1/a07e0918?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80',\n    userImageURL: PROFILE_IMAGE_EMILY_ROSE28,\n  },\n};\n\nexport const MOCKED_CATEGORIES: { [category in Category]: { [postID in Post['postID']]: Post } } = {\n  news: {\n    1: MOCKED_POSTS[1],\n    3: MOCKED_POSTS[3],\n    5: MOCKED_POSTS[5],\n    6: MOCKED_POSTS[6],\n  },\n  medical_supply: {\n    3: MOCKED_POSTS[3],\n  },\n  grocery: {\n    2: MOCKED_POSTS[2],\n    5: MOCKED_POSTS[5],\n  },\n  advice: {\n    4: MOCKED_POSTS[4],\n  },\n};\n","import { createAsyncThunk, createSelector, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\n// import { fetch } from '../../utils/fetch';\n\nimport { AppRoutes, history } from '../../app/router';\nimport { RootState } from '../../app/store';\nimport { Category } from '../feed/feedSlice';\n\nconst SLICE_NAME = 'submit';\n\ntype AsyncState = {\n  error: string | null;\n  loading: 'idle' | 'pending';\n};\n\ntype State = {\n  async: AsyncState;\n};\n\nexport type SubmitBody = {\n  categories: Category[];\n  image: string | null;\n  text: string;\n  title: string;\n  username: string | null;\n  userImageURL: string | null;\n};\n\ntype SubmitSuccess = {\n  success: boolean;\n};\n\nexport const submitted = createAsyncThunk(`${SLICE_NAME}/submitted`, (_body: SubmitBody) => {\n  history.push('/' as AppRoutes);\n});\n\nexport const slice = createSlice({\n  name: SLICE_NAME,\n  initialState: {\n    async: {\n      error: null,\n      loading: 'idle',\n    },\n  } as State,\n  reducers: {},\n  extraReducers: {\n    [submitted.pending.type]: (state): void => {\n      if (state.async.loading === 'idle') {\n        state.async.loading = 'pending';\n      }\n    },\n    [submitted.fulfilled.type]: (state, _action: PayloadAction<SubmitSuccess>): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n      }\n    },\n    [submitted.rejected.type]: (state, action: { error: Error }): void => {\n      if (state.async.loading === 'pending') {\n        state.async.loading = 'idle';\n        state.async.error = action.error.message;\n      }\n    },\n  },\n});\n\nexport const selectAsync = (state: RootState): State['async'] =>\n  createSelector(\n    (state: RootState) => state.submit.async,\n    (async) => async,\n  )(state);\n\nexport const submitReducer = slice.reducer;\n","import React, { FC } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { Box, Button, Image, PseudoBox, Link } from '@chakra-ui/core';\n\nimport { PostInfo } from './PostInfo';\n\nimport { Rating } from '../../components/Rating';\n\nimport { Post as PostType } from './feedSlice';\n\ntype Props = {\n  detailViewRedirectToProfile?: boolean;\n} & PostType;\n\nconst paddingProps = { padding: 2 };\n\nconst BORDER_RADIUS = 8;\n\nexport const FALLBACK_IMAGE_URL =\n  'https://images.unsplash.com/photo-1584118624012-df056829fbd0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=60';\n\nexport const Post: FC<Props> = ({\n  date,\n  detailViewRedirectToProfile,\n  imageURL,\n  postID,\n  rating,\n  title,\n  userImageURL,\n  username,\n}: Props) => {\n  const linkToDetailView = `/feed/detail/${postID}${detailViewRedirectToProfile ? `?redirect=profile` : ''}`;\n\n  return (\n    <>\n      <Box\n        boxShadow='0px 8px 12px rgba(42, 52, 61, 0.16078431372549)'\n        borderRadius={BORDER_RADIUS}\n        maxWidth={['initial', 'initial', 350]}\n      >\n        {/*\n        // @ts-ignore */}\n        <Link as={RouterLink} to={linkToDetailView}>\n          <Box height={128} position='relative'>\n            <PseudoBox\n              {...paddingProps}\n              background='#ffffffdd'\n              // @ts-ignore\n              borderTopRightRadius={BORDER_RADIUS}\n              bottom={0}\n              _hover={{\n                textDecoration: 'underline',\n              }}\n              position='absolute'\n              width='80%'\n            >\n              {title}\n            </PseudoBox>\n\n            <Image\n              alt='post background image'\n              // @ts-ignore\n              borderTopLeftRadius={BORDER_RADIUS}\n              // @ts-ignore\n              borderTopRightRadius={BORDER_RADIUS}\n              height='100%'\n              objectFit='cover'\n              src={imageURL ?? FALLBACK_IMAGE_URL}\n              width='100%'\n            />\n          </Box>\n        </Link>\n\n        <PostInfo date={date} userImageURL={userImageURL} username={username} style={paddingProps} />\n\n        <Box {...paddingProps} alignItems='center' display='flex'>\n          <Rating rating={rating} shouldShowDescription={false} />\n          <Button\n            as={RouterLink}\n            marginLeft={6}\n            // @ts-ignore\n            to={linkToDetailView}\n            variant='outline'\n            variantColor='blue'\n          >\n            Verify\n          </Button>\n        </Box>\n      </Box>\n    </>\n  );\n};\n","import React, { FC } from 'react';\nimport { Box, BoxProps, CircularProgress, CircularProgressLabel, Text } from '@chakra-ui/core';\n\nimport { Post } from '../features/feed/feedSlice';\n\nconst NOT_CONFIDENT = 'Based on information gathered, we do not have enough information to be confident of this data.';\nconst CONFIDENT = 'Based on information gathered, we are confident of this data.';\n\nconst colorForRating = (rating: Post['rating']): string => {\n  if (rating === null || rating < 40) {\n    return 'gray';\n  }\n\n  if (rating >= 40 && rating <= 70) {\n    return 'yellow';\n  }\n\n  return 'green';\n};\n\nconst descriptionForRating = (rating: Post['rating']): string => {\n  if (rating === null || rating < 40) {\n    return NOT_CONFIDENT;\n  }\n\n  if (rating >= 40 && rating <= 70) {\n    return NOT_CONFIDENT;\n  }\n\n  return CONFIDENT;\n};\n\ntype Props = { boxProps?: BoxProps; labelProps?: BoxProps; rating: Post['rating']; shouldShowDescription: boolean };\n\nexport const Rating: FC<Props> = ({ boxProps, labelProps, rating, shouldShowDescription }: Props) => {\n  const color = colorForRating(rating);\n\n  const circularRating = (\n    <CircularProgress\n      aria-label='reliability score of post'\n      color={color}\n      role='presentation'\n      style={boxProps}\n      trackColor={color}\n      value={rating ?? 100}\n    >\n      <CircularProgressLabel style={labelProps}>{rating ?? '?'}</CircularProgressLabel>\n    </CircularProgress>\n  );\n\n  if (!shouldShowDescription) {\n    return circularRating;\n  }\n\n  return (\n    <Box display='flex' flex={1}>\n      <Box flex={3} marginRight={4}>\n        <Text as='h3' color='gray.700' fontWeight='semibold' marginBottom={1}>\n          Confidence score:\n        </Text>\n        <Text>{descriptionForRating(rating)}</Text>\n      </Box>\n      <Box flex={1}>{circularRating}</Box>\n    </Box>\n  );\n};\n","export const convertWidthToEM = (widthPX: number): number => widthPX / parseFloat(getBodyFontSize());\n\n// @ts-ignore\nconst getBodyFontSize = (): string => getComputedStyle(document.querySelector('body'))['font-size'];\n","import React, { FC } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { Avatar, BoxProps, Link as ChakraLink, Text } from '@chakra-ui/core';\n\nimport { AppRoutes } from '../app/router';\nimport { Post } from '../features/feed/feedSlice';\n\ntype Props = {\n  style?: BoxProps;\n  userImageURL: Post['userImageURL'];\n  username: Post['username'];\n};\n\n// TS workaround\nconst Link: any = ChakraLink;\n\nexport const Author: FC<Props> = ({ style, userImageURL, username }: Props) => {\n  const profilePath = ('/profile' as AppRoutes) + `/${username}`;\n\n  return (\n    <Link as={RouterLink} to={profilePath} style={style}>\n      {userImageURL && <Avatar marginRight={2} name={username} size='xs' src={userImageURL ?? ''} />}\n      <Text as='span' color='blue.500' fontSize='sm'>\n        {username}\n      </Text>\n    </Link>\n  );\n};\n","import React, { FC } from 'react';\n\ntype Props = {\n  date: Date;\n};\n\n// https://stackoverflow.com/questions/3177836/how-to-format-time-since-xxx-e-g-4-minutes-ago-similar-to-stack-exchange-site/23259289#23259289\nconst timeSince = (date: Date): string => {\n  if (typeof date !== 'object') {\n    date = new Date(date);\n  }\n\n  // @ts-ignore\n  const seconds = Math.floor((new Date() - date) / 1000);\n  let intervalType;\n\n  let interval = Math.floor(seconds / 31536000);\n  if (interval >= 1) {\n    intervalType = 'year';\n  } else {\n    interval = Math.floor(seconds / 2592000);\n    if (interval >= 1) {\n      intervalType = 'month';\n    } else {\n      interval = Math.floor(seconds / 86400);\n      if (interval >= 1) {\n        intervalType = 'day';\n      } else {\n        interval = Math.floor(seconds / 3600);\n        if (interval >= 1) {\n          intervalType = 'hour';\n        } else {\n          interval = Math.floor(seconds / 60);\n          if (interval >= 1) {\n            intervalType = 'minute';\n          } else {\n            interval = seconds;\n            intervalType = 'second';\n          }\n        }\n      }\n    }\n  }\n\n  if (interval > 1 || interval === 0) {\n    intervalType += 's';\n  }\n\n  return interval + ' ' + intervalType;\n};\n\nexport const TimeAgo: FC<Props> = ({ date }: Props) => <>{timeSince(date)} ago</>;\n","import React, { FC } from 'react';\nimport { Box, BoxProps, Divider, Text } from '@chakra-ui/core';\n\nimport { Author } from '../../components/Author';\nimport { TimeAgo } from '../../components/TimeAgo';\n\nimport { Post as PostType } from './feedSlice';\n\ntype Props = {\n  date: PostType['date'];\n  userImageURL: PostType['userImageURL'];\n  username: PostType['username'];\n  style?: BoxProps;\n};\n\nexport const PostInfo: FC<Props> = ({ date, userImageURL, username, style }: Props) => (\n  <Box alignItems='center' display='flex' marginTop={2} {...style}>\n    <Text alignItems='center' as='span' color='gray.500' display='flex' fontSize='sm' fontWeight='normal' height='100%'>\n      <TimeAgo date={new Date(date)} />\n    </Text>\n    <Divider borderColor='gray.300' height='24px' orientation='vertical' />\n    <Author\n      style={{\n        alignItems: 'center',\n        display: 'flex',\n        height: '100%',\n      }}\n      userImageURL={userImageURL}\n      username={username}\n    />\n  </Box>\n);\n","import React, { FC, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link as RouterLink, RouteComponentProps, useHistory } from 'react-router-dom';\nimport { useWindowWidth } from '@react-hook/window-size';\nimport {\n  Box,\n  Button,\n  Drawer,\n  DrawerBody,\n  DrawerCloseButton,\n  DrawerContent,\n  DrawerFooter,\n  DrawerHeader,\n  DrawerOverlay,\n  Image,\n  Link as ChakraLink,\n  Tag,\n  Text,\n  useToast,\n} from '@chakra-ui/core';\n\nimport { PostInfo } from './PostInfo';\n\nimport { Rating } from '../../components/Rating';\n\nimport { Category, postRequested, selectPostByID } from './feedSlice';\nimport { selectOwnProfile } from '../user/userSlice';\n\nimport { convertWidthToEM } from '../../utils/dom-utils';\n\nimport { RootState } from '../../app/store';\n\nimport { FALLBACK_IMAGE_URL } from './Post';\n\nconst MOBILE_BREAKPOINT_EM = 30;\n\ntype Props = {\n  previousPathname?: string;\n} & RouteComponentProps<{ postID: string }>;\n\nexport const CATEGORY_NAMES: { [key in Category]: string } = {\n  news: 'News',\n  medical_supply: 'Medical Supply',\n  grocery: 'Grocery',\n  advice: 'Advice',\n};\n\nconst CATEGORY_LINKS: { [key in Category]: string } = {\n  advice: '/feed/advice',\n  grocery: '/feed/grocery',\n  medical_supply: '/feed/medical-supply',\n  news: '/feed/news',\n};\n\nconst Link: any = ChakraLink;\n\n// https://stackoverflow.com/questions/9038625/detect-if-device-is-ios/58065241#58065241\nconst isIOS =\n  (/iPad|iPhone|iPod/.test(navigator.platform) ||\n    (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\n  !window.MSStream;\nconst deviceSpecificProps = isIOS ? { marginTop: 24 } : {};\n\nexport const DetailView: FC<Props> = ({ match, previousPathname }: Props) => {\n  const dispatch = useDispatch();\n\n  const history = useHistory();\n\n  const toast = useToast();\n\n  const ownProfile = useSelector(selectOwnProfile).profile ?? null;\n\n  // Workaround for hidden header on mobile devices\n  const widthPX = useWindowWidth(0, {\n    leading: true,\n    wait: 250,\n  });\n  const widthEM = convertWidthToEM(widthPX);\n  const isFullHeight = widthEM <= MOBILE_BREAKPOINT_EM;\n\n  const postID: string | null = match.params.postID ?? null;\n\n  const post = useSelector((state: RootState) => selectPostByID(state, parseInt(postID)));\n\n  useEffect(() => {\n    if (post === null) {\n      dispatch(postRequested(+postID));\n    }\n  }, [dispatch, post, postID]);\n\n  if (post?.async.error) {\n    return <>TODO: Error state</>;\n  }\n\n  if (post === null || !post.post) {\n    return <>TODO: Null state</>;\n  }\n\n  const { categories, date, imageURL, rating, text, title, userImageURL, username } = post.post;\n\n  const onClose = (): void => {\n    const nextPath = previousPathname ?? '/';\n    history.push(nextPath);\n  };\n\n  const onVote = (): void => {\n    toast({\n      title: 'Vote saved.',\n      description: `Thank you for making ${\n        ownProfile?.cityName ? `content in ${ownProfile.cityName}` : 'local content'\n      } more reliable.`,\n      status: 'success',\n      duration: 7000,\n      isClosable: true,\n    });\n  };\n\n  return (\n    <Drawer scrollBehavior='inside' isFullHeight={isFullHeight} isOpen onClose={onClose} placement='bottom'>\n      <DrawerOverlay />\n      <DrawerContent>\n        <DrawerCloseButton {...deviceSpecificProps} aria-label='return to feed' />\n        <DrawerHeader\n          margin={['inherit', 'inherit', '0 auto']}\n          width={['initial', 'initial', 1000]}\n          {...deviceSpecificProps}\n        >\n          <Text as='h2'>{title}</Text>\n\n          <Box\n            marginTop={2}\n            onClick={(event): void => {\n              // Prevent Drawer#onClose from being called so history#push isn't called.\n              event.stopPropagation();\n            }}\n          >\n            {categories.map((category: Category) => (\n              <Link as={RouterLink} key={category} to={CATEGORY_LINKS[category]}>\n                <Tag marginRight={2} size='sm'>\n                  {CATEGORY_NAMES[category]}\n                </Tag>\n              </Link>\n            ))}\n          </Box>\n\n          <div\n            // eslint-disable-next-line\n            onClick={(event): void => {\n              // Prevent Drawer#onClose from being called so history#push isn't called.\n              event.stopPropagation();\n            }}\n            role='presentation'\n          >\n            <PostInfo date={date} style={{ marginTop: 4 }} userImageURL={userImageURL} username={username} />\n          </div>\n        </DrawerHeader>\n\n        <DrawerBody margin='0 auto' maxWidth='1000px' width={['initial', 'initial', 1000]}>\n          <Image alt='post image' maxHeight={150} src={imageURL ?? FALLBACK_IMAGE_URL} />\n\n          <Box marginTop={6}>\n            <Text>{text}</Text>\n          </Box>\n\n          <Box display='flex' marginTop={[4, 8, 12]}>\n            <Rating\n              boxProps={{\n                height: '100%',\n                width: '100%',\n                maxWidth: 70,\n                maxHeight: 70,\n              }}\n              labelProps={{\n                fontSize: '16px',\n              }}\n              rating={rating}\n              shouldShowDescription\n            />\n          </Box>\n        </DrawerBody>\n\n        <DrawerFooter maxWidth='1000px' width={['initial', 'initial', 1000]} margin={['initial', 'initial', '0 auto']}>\n          <Button\n            onClick={(): void => {\n              onVote();\n              onClose();\n            }}\n            variant='ghost'\n            variantColor='blue'\n          >\n            Disconfirm\n          </Button>\n          <Button\n            marginLeft={4}\n            onClick={(): void => {\n              onVote();\n              onClose();\n            }}\n            variantColor='blue'\n          >\n            Confirm\n          </Button>\n        </DrawerFooter>\n      </DrawerContent>\n    </Drawer>\n  );\n};\n"],"sourceRoot":""}